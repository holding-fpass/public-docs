### Introduction

Webhooks, also known as HTTP Callbacks, are a way to register to receive useful information at a specific URL of your choice.

When a change occurs in the state of a resource within the platform, such as a successful transaction approval, an event is generated by this occurrence and sent to the registered webhooks.

Webhook documentation: [COMING SOON]

**It is crucial that your event-receiving system is designed to handle notifications from the platform, following the asynchronous integration paradigm. This means receiving the messages and storing them in queues for later internal consumption by your system. This approach enhances availability, maintainability, and recovery of these integrations.**

### How Events are Triggered

#### Event Generation
Regardless of whether webhooks are registered, events are generated whenever their trigger condition is satisfied. These events are available in our event listing APIs, although we strongly discourage the use of these APIs for event reading through crawling.

#### Webhook Triggers
When an event is generated, and there are registered webhooks to receive that type of event, the triggers are scheduled for a few seconds after the event is generated. This delay allows your system to complete necessary tasks after responding to the request that generated the event, preventing triggers from occurring before data propagation between the software components of your system.

### Important
The URL of your webhook must be exposed (public) to the internet so that the platform can reach it and send the events.

### Retry Flow for Triggers
If the first delivery attempt fails, the platform will retry within a few moments. After a maximum of 3 unsuccessful attempts, the event enters a delivery failure state. It is the consumer's responsibility to maintain the resilience of the events and handle event deduplication.

### Timeouts
During the trigger of an event to one of your webhooks, the platform expects to receive a response within 1 second. If this time expires, the connection is closed.

### Transaction Payment Events

The transaction payment event captures the essential details of a transaction within the platform. This event is crucial to ensure that all stakeholders are adequately notified about the transaction's status, enabling proper processing and accurate record-keeping.

Below are the key properties associated with this event, including unique identifiers, detailed information about the transaction, and specific data about the partner and whitelabel platform. These properties are essential for tracking, auditing, and managing transactions within the platform ecosystem.

### 1. **transaction.canceled**
- **Description**: This event is triggered when a transaction is canceled (reversed). The cancellation is done by the platform at the user's request.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "dfbecba9-bfb2-47e9-8797-23b2ca7a8505",
  "resourceType": "partner.event",
  "partnerId": "ef0c3466-a36a-49fe-a810-681e6ba9e505",
  "type": "transaction.canceled",
  "payload": {
    "resourceId": "492f8606-075d-402e-8fef-f44d823ec662",
    "resourceType": "transaction",
    "productId": "12b73a55-0186-42f8-9e07-5e7ebeac632d",
    "productType": "platform.subscription",
    "status": "canceled",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": null,
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "bd6b0ce2-3758-4feb-bacc-b86935a9e5e5",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

### 2. **transaction.disputed**
- **Description**: This event is triggered when a transaction is disputed, meaning that a buyer challenges the validity of a charge made.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "3d9ec97e-a4f7-4cb5-9ef7-4e5f9b1d7b8b",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.disputed",
  "payload": {
    "resourceId": "9f6c4e52-0a74-4a38-a7c3-ef5f4f4b6a78",
    "resourceType": "transaction",
    "productId": "5e4c85b2-7d34-4694-ae62-8c9c4fb1a839",
    "productType": "platform.subscription",
    "status": "dispute",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": null,
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 3. **transaction.dispute.succeeded**
- **Description**: This event is triggered when a dispute over a transaction is successfully resolved in favor of the disputing user.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "7d1ef752-17c3-434f-843e-c85a01a92d90",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.dispute.succeeded",
  "payload": {
    "resourceId": "fbb23e8e-3d8a-4d7f-b9f4-1a7f123bb6d8",
    "resourceType": "transaction",
    "productId": "ecf6b3db-6c9e-4f5a-9a68-5a3e6b7322b3",
    "productType": "platform.subscription",
    "status": "dispute",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Dispute successfully resolved",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": "2020-04-30T10:20:00.000Z",
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": "2020-04-30T10:20:00.000Z",
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 4. **transaction.failed**
- **Description**: This event is triggered when a transaction fails due to authorization issues, insufficient funds, or other reasons that prevent the transaction from being completed.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "8eb29c4b-1d7c-4f3a-8c9f-7e54c4b44b29",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.failed",
  "payload": {
    "resourceId": "a3b2d7c4-5d8c-4a9f-b7d6-7a9f4b3e6d87",
    "resourceType": "transaction",
    "productId": "d3c9b6f7-4f6b-4a8b-b5d4-6e9c3f7a9d65",
    "productType": "platform.subscription",
    "status": "failed",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction failed",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 5. **transaction.pre_authorization.succeeded**
- **Description**: This event is triggered when a transaction pre-authorization is successfully completed, reserving the amount in the customer's account before final capture.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "1b7e2b5f-4c4a-44c2-8d9b-84b4fbc8c6c5",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.pre_authorization.succeeded",
  "payload": {
    "resourceId": "ae9b6d3a-4c6b-4b8d-8f6e-2e7b7f5a9d65",
    "resourceType": "transaction",
    "productId": "e4b2d6f8-4f5b-4c8b-8d6f-2f7a3c6d8b5a",
    "productType": "platform.subscription",
    "status": "pre_authorized",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction pre-authorization successfully completed",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 6. **transaction.pre_authorized**
- **Description**: This event is triggered when a transaction is pre-authorized, indicating that the amount has been reserved but not yet captured.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "a9c3b5e6-8b6d-4a6f-9b7e-6d3f9b6a7e9f",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.pre_authorized",
  "payload": {
    "resourceId": "6b4e5a7c-8f6d-4b9a-8c7d-2e7a4b5f8d6c",
    "resourceType": "transaction",
    "productId": "a9c6d5b7-4c6b-4b8a-8f5d-2e7a4b5f8c7d",
    "productType": "platform.subscription",
    "status": "pre_authorized",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction pre-authorized",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 7. **transaction.reversed**
- **Description**: This event is triggered when a transaction is reversed, meaning that the charged amount is refunded to the customer after the transaction is completed.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "b3e4d6f7-5c7a-4b8d-8f5e-2d7b4a6f8c7e",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.reversed",
  "payload": {
    "resourceId": "9d6b7f8a-4c6d-4b8a-9f7c-2e6b3c7d9f4a",
    "resourceType": "transaction",
    "productId": "d4c7b6f8-5c6d-4b8a-9e7f-2d7c4f6b9a8d",
    "productType": "platform.subscription",
    "status": "refunded",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction reversed",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": "2020-04-30T10:20:00.000Z",
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": "2020-04-30T10:20:00.000Z",
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 8. **transaction.succeeded**
- **Description**: This event is triggered when a transaction is successfully completed, indicating that the payment has been processed and the amount has been captured.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "d4b7f5c8-5c8b-4d8a-9f7e-6c9b7d6f9a8e",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.succeeded",
  "payload": {
    "resourceId": "e6d7f5c9-4d8a-4b8f-9e6c-2f7b6d9f8a7e",
    "resourceType": "transaction",
    "productId": "d4c7b6f8-5c6d-4b8a-9e7f-2d7c4f6b9a8d",
    "productType": "platform.subscription",
    "status": "succeeded",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction successfully completed",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 9. **transaction.updated**
- **Description**: This event is triggered when an existing transaction is updated, which may include changes to status, values, or payment information.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "e6d7f5c9-4d8a-4b8f-9e6c-2f7b6d9f8a7e",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.updated",
  "payload": {
    "resourceId": "d4c7b6f8-5c6d-4b8a-9e7f-2d7c4f6b9a8d",
    "resourceType": "transaction",
    "productId": "e6d7f5c9-4d8a-4b8f-9e6c-2f7b6d9f8a7e",
    "productType": "platform.subscription",
    "status": "created",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction updated",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 10. **transaction.void.failed**
- **Description**: This event is triggered when an attempt to void a transaction fails, indicating that the transaction could not be canceled or reversed.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "d4c7b6f8-5c6d-4b8a-9e7f-2d7c4f6b9a8d",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.void.failed",
  "payload": {
    "resourceId": "e6d7f5c9-4d8a-4b8f-9e6c-2f7b6d9f8a7e",
    "resourceType": "transaction",
    "productId": "d4c7b6f8-5c6d-4b8a-9e7f-2d7c4f6b9a8d",
    "productType": "platform.subscription",
    "status": "succeeded",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Attempt to void the transaction failed",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 11. **transaction.void.succeeded**
- **Description**: This event is triggered when an attempt to void a transaction is successful, indicating that the transaction has been successfully canceled or reversed.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "e6d7f5c9-4d8a-4b8f-9e6c-2f7b6d9f8a7e",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.void.succeeded",
  "payload": {
    "resourceId": "d4c7b6f8-5c6d-4b8a-9e7f-2d7c4f6b9a8d",
    "resourceType": "transaction",
    "productId": "e6d7f5c9-4d8a-4b8f-9e6c-2f7b6d9f8a7e",
    "productType": "platform.subscription",
    "status": "canceled",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction successfully voided",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": "2020-04-30T10:20:00.000Z",
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": "2020-04-30T10:20:00.000Z",
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

### 12. **transaction.charged_back**
- **Description**: This event is triggered when a transaction undergoes a chargeback. This occurs when the buyer disputes the charge, and the amount is refunded.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "aebec7e1-4bfa-4c91-8f71-ecf2e8c7bb0f",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.charged_back",
  "payload": {
    "resourceId": "59a4c612-dc2e-4e88-9c58-fdbebc37f1e8",
    "resourceType": "transaction",
    "productId": "24c073d4-3f42-4a9c-b649-2e9f0f734dbf",
    "productType": "platform.subscription",
    "status": "charged_back",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Transaction charged back",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": "2020-04-30T10:20:00.000Z",
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 13. **transaction.commission.succeeded**
- **Description**: This event is triggered when the commission calculation for a transaction is successfully completed. This calculation is important for partners who receive commissions based on transactions.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "4e9b1f3b-8df9-4828-9a5b-373e5a745bdd",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.commission.succeeded",
  "payload": {
    "resourceId": "59a4c612-dc2e-4e88-9c58-fdbebc37f1e8",
    "resourceType": "transaction",
    "productId": "24c073d4-3f42-4a9c-b649-2e9f0f734dbf",
    "productType": "platform.subscription",
    "status": "succeeded",
    "couponId": null,
    "transactionIds": [],
    "currency": "BRL",
    "description": "Commission successfully calculated",
    "paymentMethod": "credit",
    "value": 49700,
    "commissionValue": 4970,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

---

### 14. **transaction.created**
- **Description**: This event is triggered when a new transaction is created in the system. This event is used to log the start of a transaction.

#### **Event Structure (JSON)**
```json
{
  "resourceId": "cfe24b4e-6ff4-46f1-8c48-5d3d0ec7efc6",
  "resourceType": "partner.event",
  "partnerId": "bca7d6c4-1b8a-4f25-99f4-d6a06f3b5f02",
  "type": "transaction.created",
  "payload": {
    "resourceId": "76d8fbb9-bf60-42fe-a6bc-9c7a4bf59367",
    "resourceType": "transaction",
    "productId": "3f2f7b4a-8c7b-4371-9a74-f7e27ab4fbcd",
    "productType": "platform.subscription",
    "status": "created",
    "couponId": "e25b7fb3-8d6f-48f3-b5f4-0dfe479b5b4d",
    "transactionIds": [],
    "currency": "BRL",
    "description": "New transaction created",
    "paymentMethod": "credit",
    "value": 49700,
    "splitProcessedAt": null,
    "refundedAt": null,
    "userId": "8cf86a4d-57b9-45e1-9f21-2f8b788f11ef",
    "metadata": null,
    "whitelabel": "test",
    "createdAt": "2020-04-30T10:20:00.000Z",
    "updatedAt": "2020-04-30T10:20:00.000Z"
  },
  "processedAt": null,
  "retries": 0,
  "metadata": null,
  "whitelabel": "test",
  "createdAt": "2020-04-30T10:20:00.000Z",
  "updatedAt": "2020-04-30T10:20:00.000Z"
}
```

### Conclusion
This documentation has been created to provide a comprehensive and detailed overview of events related to payment transactions within the platform. 
By following the steps outlined in this documentation, you can implement the Fpass platform's payment system efficiently and securely. Be sure to follow all steps correctly to ensure a successful integration.
